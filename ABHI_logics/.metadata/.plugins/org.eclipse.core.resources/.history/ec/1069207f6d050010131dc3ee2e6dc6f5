package Logics;

import java.io.*;
import java.util.zip.*;

public class UnzipAndCheckTheContent {

	public static void extractZipFile(String zipFilePath, String destinationFolder) throws IOException {
		File destFolder = new File(destinationFolder);
		if (!destFolder.exists()) {
			destFolder.mkdirs();
		}

		try (ZipInputStream zipInputStream = new ZipInputStream(new FileInputStream(zipFilePath))) {
			ZipEntry entry;

			while ((entry = zipInputStream.getNextEntry()) != null) {
				File outputFile = new File(destinationFolder, entry.getName());

				if (entry.isDirectory()) {
					outputFile.mkdirs();
				} else {
					File parentDir = outputFile.getParentFile();
					if (parentDir != null && !parentDir.exists()) {
						parentDir.mkdirs();
					}

					try (BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(outputFile))) {
						byte[] buffer = new byte[1024];
						int bytesRead;
						while ((bytesRead = zipInputStream.read(buffer)) != -1) {
							bos.write(buffer, 0, bytesRead);
						}
					}
				}
				zipInputStream.closeEntry(); // Close the current entry
			}
		}
	}

	public static void main(String[] args) {
		// Define the path to the ZIP file and the destination folder for extraction
		String zipFilePath = "C:\\Users\\User\\Downloads\\Calculators-20250320T074810Z-001.zip"; 
		String destinationFolder = "C:\\Users\\User\\Downloads\\ABHIExtractedPath"; 

		try {
			System.out.println("Extracting ZIP file...");
			extractZipFile(zipFilePath, destinationFolder);
			System.out.println("Extraction complete!");

			File calculatorsFolder = new File(destinationFolder, "Calculators");

			if (calculatorsFolder.exists() && calculatorsFolder.isDirectory()) {
				File[] subfolders = calculatorsFolder.listFiles();

				if (subfolders != null) {
					for (File folder : subfolders) {
						if (folder.isDirectory()) {
							System.out.println("Folder: " + folder.getName());

							File[] contents = folder.listFiles();

							if (contents != null && contents.length > 0) {
								System.out.println("Contents of " + folder.getName() + ":");
								for (File content : contents) {
									System.out.println(" - " + content.getName());
								}
							} else {
								System.out.println("No contents found inside " + folder.getName());
							}

							System.out.println(folder.getName());
						}
					}
				}
			} else {
				System.out.println("The 'Calculators' directory does not exist or is not a directory.");
			}

		} catch (IOException e) {
			e.printStackTrace();
			System.out.println("Error extracting ZIP file.");
		}
	}
}
