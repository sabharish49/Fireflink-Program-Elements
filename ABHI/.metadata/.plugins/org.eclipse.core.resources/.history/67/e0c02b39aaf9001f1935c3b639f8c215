package org.hem.excel;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;


public class SingleCell {
	public static void main(String[] args) throws IOException {
		boolean valueFound=false;
		String fileName="C:\\Users\\User\\Downloads\\Premium Calculators (002)_Old products\\Premium Calculators\\Activ_Fit_Calculator V1.xlsm";
		String searchValue="Family Construct";
		File excelFile=new File(fileName);
String value="2A";
		try(FileInputStream fis = new FileInputStream(excelFile);
                Workbook workbook = WorkbookFactory.create(fis))  {
       
            Sheet sheet = workbook.getSheet("FF Calculator");
            int rowCount = sheet.getLastRowNum(); 
            for (int i = 0; i < rowCount; i++) {
                Row row = sheet.getRow(i);

                if (row != null) {
                    for (int j = 0; j < row.getPhysicalNumberOfCells(); j++) {
                        Cell cell = row.getCell(j);

                        if (cell != null && cell.toString().trim().equalsIgnoreCase(searchValue)) {
                            Cell nextCell = row.getCell(j + 1);
                            if (nextCell == null) {
                                nextCell = row.createCell(j + 1); 
                            }
                            nextCell.setCellValue(value);
                            valueFound = true;
                            break; 
                        }
                    }
                }

                if (valueFound) {
                    break; 
                }
            }
            if (!valueFound) {
               FailMessg
            } else {
             
            	
	            try (FileOutputStream fos = new FileOutputStream(fileName)) {
	                workbook.write(fos);
	                PassMessage
	                System.out.println("Dropdown value modified.");
	                workbook.close();
	                fos.close();
	            }
            	
                }
            }
		
		
	}
        
	
		
	}
